<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Llvmutils (llvmutils.Llvmutils)</title><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">llvmutils</a> &#x00BB; Llvmutils</nav><header class="odoc-preamble"><h1>Module <code><span>Llvmutils</span></code></h1></header><nav class="odoc-toc"><ul><li><a href="#debug-information">Debug information</a></li><li><a href="#helper-functions">Helper functions</a></li><li><a href="#test-functions">Test functions</a></li><li><a href="#pretty-printers">Pretty printers</a></li></ul></nav><div class="odoc-content"><h3 id="debug-information"><a href="#debug-information" class="anchor"></a>Debug information</h3><div class="odoc-spec"><div class="spec type anchored" id="type-debug_loc"><a href="#type-debug_loc" class="anchor"></a><code><span><span class="keyword">type</span> debug_loc</span><span> = </span><span>{</span></code><ol><li id="type-debug_loc.filename" class="def record field anchored"><a href="#type-debug_loc.filename" class="anchor"></a><code><span>filename : string;</span></code></li><li id="type-debug_loc.funname" class="def record field anchored"><a href="#type-debug_loc.funname" class="anchor"></a><code><span>funname : string;</span></code></li><li id="type-debug_loc.line" class="def record field anchored"><a href="#type-debug_loc.line" class="anchor"></a><code><span>line : int;</span></code></li><li id="type-debug_loc.column" class="def record field anchored"><a href="#type-debug_loc.column" class="anchor"></a><code><span>column : int;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-debug_location"><a href="#val-debug_location" class="anchor"></a><code><span><span class="keyword">val</span> debug_location : <span><span class="xref-unresolved">Llvm</span>.llcontext <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-debug_loc">debug_loc</a> option</span></span></code></div></div><h3 id="helper-functions"><a href="#helper-functions" class="anchor"></a>Helper functions</h3><div class="odoc-spec"><div class="spec value anchored" id="val-iter_all_instr"><a href="#val-iter_all_instr" class="anchor"></a><code><span><span class="keyword">val</span> iter_all_instr : <span><span>(<span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Llvm</span>.llmodule <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>iter_all_instr f m</code> applies function <code>f</code> in turn to all instructions in <code>m</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-fold_left_all_instr"><a href="#val-fold_left_all_instr" class="anchor"></a><code><span><span class="keyword">val</span> fold_left_all_instr : 
  <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Llvm</span>.llmodule <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>fold_left_all_instr f a m</code> returns <code>f (... f (f (f a i1) i2) i3 ...) in</code>, where <code>i1..in</code> are the instructions in <code>m</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_main"><a href="#val-find_main" class="anchor"></a><code><span><span class="keyword">val</span> find_main : <span><span class="xref-unresolved">Llvm</span>.llmodule <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Llvm</span>.llvalue</span></code></div><div class="spec-doc"><p><code>find_main llm</code> returns a function with name <code>main</code> in a given llmodule <code>llm</code>. If no such function exists, <code>failwith &quot;main funtion not found&quot;</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-entry_point"><a href="#val-entry_point" class="anchor"></a><code><span><span class="keyword">val</span> entry_point : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="xref-unresolved">Llvm</span>.llbasicblock, <span class="xref-unresolved">Llvm</span>.llvalue)</span> <span class="xref-unresolved">Llvm</span>.llpos</span></span></code></div><div class="spec-doc"><p><code>entry_point fn</code> returns the first position of the instruction list corresponding to the function <code>fn</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_function"><a href="#val-get_function" class="anchor"></a><code><span><span class="keyword">val</span> get_function : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Llvm</span>.llvalue</span></code></div><div class="spec-doc"><p><code>get_function instr</code> returns the function that contains <code>instr</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_next_nonphi"><a href="#val-get_next_nonphi" class="anchor"></a><code><span><span class="keyword">val</span> get_next_nonphi : 
  <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="xref-unresolved">Llvm</span>.llbasicblock, <span class="xref-unresolved">Llvm</span>.llvalue)</span> <span class="xref-unresolved">Llvm</span>.llpos</span></span></code></div><div class="spec-doc"><p><code>get_next_nonphi instr</code> returns the position of the instruction that is not <code>Llvm.Opcode.PHI</code> after <code>instr</code>, or raise <code>Not_found</code> if there is no such instruction in the same basic block.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_next_phi"><a href="#val-get_next_phi" class="anchor"></a><code><span><span class="keyword">val</span> get_next_phi : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="xref-unresolved">Llvm</span>.llbasicblock, <span class="xref-unresolved">Llvm</span>.llvalue)</span> <span class="xref-unresolved">Llvm</span>.llpos</span></span></code></div><div class="spec-doc"><p><code>get_next_phi instr</code> returns the position of the instruction that is <code>Llvm.Opcode.PHI</code> after <code>instr</code>, or raise <code>Not_found</code> if there is no such instruction in the same basic block.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-neg_pred"><a href="#val-neg_pred" class="anchor"></a><code><span><span class="keyword">val</span> neg_pred : <span><span class="xref-unresolved">Llvm</span>.Icmp.t <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Llvm</span>.Icmp.t</span></code></div><div class="spec-doc"><p><code>neg_pred pr</code> is negated form of the predicate <code>pr</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-flip_pred"><a href="#val-flip_pred" class="anchor"></a><code><span><span class="keyword">val</span> flip_pred : <span><span class="xref-unresolved">Llvm</span>.Icmp.t <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Llvm</span>.Icmp.t</span></code></div><div class="spec-doc"><p><code>flip_pred pr</code> is flipped form of the predicate <code>pr</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-function_name"><a href="#val-function_name" class="anchor"></a><code><span><span class="keyword">val</span> function_name : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>function_name instr</code> returns the name of the function called at <code>instr</code>. If <code>instr</code> is not a function call, it may crash.</p></div></div><h3 id="test-functions"><a href="#test-functions" class="anchor"></a>Test functions</h3><div class="odoc-spec"><div class="spec value anchored" id="val-is_assignment"><a href="#val-is_assignment" class="anchor"></a><code><span><span class="keyword">val</span> is_assignment : <span><span class="xref-unresolved">Llvm</span>.Opcode.t <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>check if a given LLVM instruction is an assignment operator.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_assignment_instr"><a href="#val-is_assignment_instr" class="anchor"></a><code><span><span class="keyword">val</span> is_assignment_instr : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>check if a given LLVM instruction is an assignment instruction.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_phi"><a href="#val-is_phi" class="anchor"></a><code><span><span class="keyword">val</span> is_phi : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>check if a given LLVM instruction is a phi node.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_unary_op"><a href="#val-is_unary_op" class="anchor"></a><code><span><span class="keyword">val</span> is_unary_op : <span><span class="xref-unresolved">Llvm</span>.Opcode.t <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>check if a given LLVM instruction is a unary operator.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_binary_op"><a href="#val-is_binary_op" class="anchor"></a><code><span><span class="keyword">val</span> is_binary_op : <span><span class="xref-unresolved">Llvm</span>.Opcode.t <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>check if a given LLVM instruction is a binary operator.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_call"><a href="#val-is_call" class="anchor"></a><code><span><span class="keyword">val</span> is_call : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>check if a given LLVM instruction is a function call.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_argument"><a href="#val-is_argument" class="anchor"></a><code><span><span class="keyword">val</span> is_argument : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_argument instr</code> checks if <code>instr</code> is <code>Llvm.ValueKind.Argument</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_input"><a href="#val-is_input" class="anchor"></a><code><span><span class="keyword">val</span> is_input : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_input instr</code> checks if <code>instr</code> is <code>Llvm.Opcode.Call</code> and the callee is <code>input</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_print"><a href="#val-is_print" class="anchor"></a><code><span><span class="keyword">val</span> is_print : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_print instr</code> checks if <code>instr</code> is <code>Llvm.Opcode.Call</code> and the callee is <code>print</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_print_num"><a href="#val-is_print_num" class="anchor"></a><code><span><span class="keyword">val</span> is_print_num : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_print_num instr</code> checks if <code>instr</code> is <code>Llvm.Opcode.Call</code> and the callee is <code>print_num</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_print_ptr"><a href="#val-is_print_ptr" class="anchor"></a><code><span><span class="keyword">val</span> is_print_ptr : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_print_ptr instr</code> checks if <code>instr</code> is <code>Llvm.Opcode.Call</code> and the callee is <code>print_ptr</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_print_mem"><a href="#val-is_print_mem" class="anchor"></a><code><span><span class="keyword">val</span> is_print_mem : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_print_mem instr</code> checks if <code>instr</code> is <code>Llvm.Opcode.Call</code> and the callee is <code>print_mem</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_malloc"><a href="#val-is_malloc" class="anchor"></a><code><span><span class="keyword">val</span> is_malloc : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_malloc instr</code> checks if <code>instr</code> is <code>Llvm.Opcode.Call</code> and the callee is <code>malloc</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_source"><a href="#val-is_source" class="anchor"></a><code><span><span class="keyword">val</span> is_source : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_source instr</code> checks if <code>instr</code> is <code>Llvm.Opcode.Call</code> and the callee is <code>source</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_sink"><a href="#val-is_sink" class="anchor"></a><code><span><span class="keyword">val</span> is_sink : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_sink instr</code> checks if <code>instr</code> is <code>Llvm.Opcode.Call</code> and the callee is <code>sink</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_sanitizer"><a href="#val-is_sanitizer" class="anchor"></a><code><span><span class="keyword">val</span> is_sanitizer : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_sanitizer instr</code> checks if <code>instr</code> is <code>Llvm.Opcode.Call</code> and the callee is <code>sanitizer</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_assume"><a href="#val-is_assume" class="anchor"></a><code><span><span class="keyword">val</span> is_assume : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_assume instr</code> checks if <code>instr</code> is <code>Llvm.Opcode.Call</code> and the callee is <code>assume</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_assert_fail"><a href="#val-is_assert_fail" class="anchor"></a><code><span><span class="keyword">val</span> is_assert_fail : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_assert_fail instr</code> checks if <code>instr</code> is <code>Llvm.Opcode.Call</code> and the callee is <code>__assert_fail</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_debug"><a href="#val-is_debug" class="anchor"></a><code><span><span class="keyword">val</span> is_debug : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_debug instr</code> checks if <code>instr</code> is <code>Llvm.Opcode.Call</code> and the callee is a LLVM debug function.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_llvm_intrinsic"><a href="#val-is_llvm_intrinsic" class="anchor"></a><code><span><span class="keyword">val</span> is_llvm_intrinsic : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_llvm_intrinsic instr</code> checks if <code>instr</code> is <code>Llvm.Opcode.Call</code> and the callee is a LLVM intrinsic function.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-first_label"><a href="#val-first_label" class="anchor"></a><code><span><span class="keyword">val</span> first_label : <span><span class="xref-unresolved">Llvm</span>.llmodule <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="xref-unresolved">Llvm</span>.llbasicblock, <span class="xref-unresolved">Llvm</span>.llvalue)</span> <span class="xref-unresolved">Llvm</span>.llpos</span></span></code></div><div class="spec-doc"><p><code>first_label m</code> returns the first position of the instruction list in the module <code>m</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_llvm_function"><a href="#val-is_llvm_function" class="anchor"></a><code><span><span class="keyword">val</span> is_llvm_function : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><h3 id="pretty-printers"><a href="#pretty-printers" class="anchor"></a>Pretty printers</h3><div class="odoc-spec"><div class="spec value anchored" id="val-string_of_instr"><a href="#val-string_of_instr" class="anchor"></a><code><span><span class="keyword">val</span> string_of_instr : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>string_of_instr i</code> returns the string representation of a LLVM instruction <code>i</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-string_of_lhs"><a href="#val-string_of_lhs" class="anchor"></a><code><span><span class="keyword">val</span> string_of_lhs : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>string_of_lhs i</code> returns the string representation of the lhs variable of a LLVM instruction <code>i</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-string_of_exp"><a href="#val-string_of_exp" class="anchor"></a><code><span><span class="keyword">val</span> string_of_exp : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>string_of_exp i</code> returns the string representation of a LLVM expression <code>i</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-string_of_function"><a href="#val-string_of_function" class="anchor"></a><code><span><span class="keyword">val</span> string_of_function : <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>string_of_exp fn</code> returns the string representation of a LLVM expression of a function <code>fn</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-string_of_location"><a href="#val-string_of_location" class="anchor"></a><code><span><span class="keyword">val</span> string_of_location : <span><span class="xref-unresolved">Llvm</span>.llcontext <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Llvm</span>.llvalue <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>string_of_location ctx i</code> returns the string representation of the location of a LLVM instruction <code>i</code>.</p></div></div></div></body></html>